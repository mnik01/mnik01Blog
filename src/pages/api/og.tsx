/* eslint-disable @typescript-eslint/ban-ts-comment */
/* eslint-disable @next/next/no-img-element */
// /pages/api/og.tsx

import { ImageResponse } from '@vercel/og';
import { NextRequest } from 'next/server';

export const config = {
  runtime: 'experimental-edge',
};

export default function handler(req: NextRequest) {
  try {
    const { searchParams } = new URL(req.url);

    // ?title=<title>
    const hasTitle = searchParams.has('title');
    const title = hasTitle
      ? searchParams.get('title')?.slice(0, 100)
      : '';

    return new ImageResponse(
      (
        <div
        style={{
            height: "100%",
            width: "100%",
            fontFamily: "'Lato', sans-srif",
            display: "flex",
            backgroundImage: "url(https://i.postimg.cc/T1fdJ8C2/image.png)",
        }}
        >
        <div
            style={{
            background:
                "linear-gradient(90deg, rgba(218, 227, 252, 0.213) 3.25%, rgba(255, 255, 255, 0.162) 36.29%, rgba(217, 217, 217, 0) 83.27%)",
            }}
            tw="absolute top-0 left-0 w-full h-full"
        />
        {hasTitle ? (
            <div tw="w-[653px] justify-center h-full absoulte top-0 left-[79px] flex gap-10 flex-col items-left">
                <svg
                    width="157"
                    height="33"
                    viewBox="0 0 157 33"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                >
                    <path
                    d="M31.354 0.869998V32H29.396V5.468C29.396 5.08666 29.418 4.68333 29.462 4.258L17.208 26.016C17.0027 26.3973 16.7093 26.588 16.328 26.588H15.976C15.5947 26.588 15.3013 26.3973 15.096 26.016L2.512 4.214C2.556 4.654 2.578 5.072 2.578 5.468V32H0.598V0.869998H2.16C2.36533 0.869998 2.52667 0.891998 2.644 0.935999C2.76133 0.979999 2.87867 1.09733 2.996 1.288L15.558 22.936C15.778 23.3467 15.9687 23.7867 16.13 24.256C16.218 24.0213 16.3133 23.794 16.416 23.574C16.5187 23.3393 16.6287 23.1193 16.746 22.914L28.956 1.288C29.0733 1.09733 29.1907 0.979999 29.308 0.935999C29.44 0.891998 29.6087 0.869998 29.814 0.869998H31.354ZM64.5829 0.869998V32H63.5269C63.3363 32 63.1749 31.9707 63.0429 31.912C62.9256 31.8387 62.8083 31.7213 62.6909 31.56L42.4729 4.544C42.5169 4.984 42.5389 5.402 42.5389 5.798V32H40.5589V0.869998H41.6809C41.8863 0.869998 42.0403 0.899332 42.1429 0.958C42.2603 1.002 42.3849 1.112 42.5169 1.288L62.6909 28.238C62.6469 27.798 62.6249 27.38 62.6249 26.984V0.869998H64.5829ZM76.0398 32H73.7738V0.869998H76.0398V32ZM87.5124 15.236H89.3604C89.6391 15.236 89.8811 15.2287 90.0864 15.214C90.2918 15.1847 90.4751 15.1407 90.6364 15.082C90.8124 15.0233 90.9664 14.9427 91.0984 14.84C91.2451 14.7227 91.3991 14.5833 91.5604 14.422L104.122 1.508C104.342 1.25866 104.555 1.09 104.76 1.002C104.98 0.913999 105.237 0.869998 105.53 0.869998H107.334L93.7384 14.84C93.4598 15.1333 93.2104 15.3607 92.9904 15.522C92.7851 15.6833 92.5504 15.8153 92.2864 15.918C92.5944 16.006 92.8731 16.1453 93.1224 16.336C93.3718 16.512 93.6211 16.7467 93.8704 17.04L108.192 32H106.366C105.985 32 105.706 31.956 105.53 31.868C105.369 31.7653 105.208 31.6113 105.046 31.406L91.8904 17.942C91.7291 17.7807 91.5751 17.6413 91.4284 17.524C91.2964 17.4067 91.1424 17.3113 90.9664 17.238C90.8051 17.15 90.6071 17.0913 90.3724 17.062C90.1524 17.018 89.8664 16.996 89.5144 16.996H87.5124V32H85.2464V0.869998H87.5124V15.236ZM132.492 16.424C132.492 19.152 132.199 21.5133 131.612 23.508C131.025 25.5027 130.226 27.1527 129.214 28.458C128.202 29.7633 127.014 30.7387 125.65 31.384C124.301 32.0147 122.856 32.33 121.316 32.33C119.776 32.33 118.331 32.0147 116.982 31.384C115.633 30.7387 114.452 29.7633 113.44 28.458C112.428 27.1527 111.629 25.5027 111.042 23.508C110.47 21.5133 110.184 19.152 110.184 16.424C110.184 13.696 110.47 11.3347 111.042 9.34C111.629 7.34533 112.428 5.69533 113.44 4.39C114.452 3.08466 115.633 2.11666 116.982 1.486C118.331 0.840664 119.776 0.517998 121.316 0.517998C122.856 0.517998 124.301 0.840664 125.65 1.486C127.014 2.11666 128.202 3.08466 129.214 4.39C130.226 5.69533 131.025 7.34533 131.612 9.34C132.199 11.3347 132.492 13.696 132.492 16.424ZM130.292 16.424C130.292 13.9013 130.05 11.7453 129.566 9.956C129.082 8.16666 128.429 6.70733 127.608 5.578C126.801 4.434 125.848 3.598 124.748 3.07C123.663 2.542 122.519 2.278 121.316 2.278C120.113 2.278 118.969 2.542 117.884 3.07C116.799 3.598 115.845 4.434 115.024 5.578C114.203 6.70733 113.55 8.16666 113.066 9.956C112.582 11.7453 112.34 13.9013 112.34 16.424C112.34 18.9613 112.582 21.1247 113.066 22.914C113.55 24.6887 114.203 26.148 115.024 27.292C115.845 28.4213 116.799 29.25 117.884 29.778C118.969 30.2913 120.113 30.548 121.316 30.548C122.519 30.548 123.663 30.2913 124.748 29.778C125.848 29.25 126.801 28.4213 127.608 27.292C128.429 26.148 129.082 24.6887 129.566 22.914C130.05 21.1247 130.292 18.9613 130.292 16.424ZM156.036 30.372V32H139.976V30.372H147.126V5.116C147.126 4.61733 147.148 4.08933 147.192 3.532L140.328 9.626C140.122 9.802 139.917 9.868 139.712 9.824C139.506 9.78 139.345 9.692 139.228 9.56L138.59 8.68L147.588 0.737997H149.238V30.372H156.036Z"
                    fill="#505054"
                    />
                </svg>
                <p tw="text-[66px] text-[#434448]">{title}</p>
            </div>
        ) : (
            <div tw="w-[653px] items-center h-full absoulte top-0 left-[79px] flex gap-10 ">
            <svg
                width="538"
                height="111"
                viewBox="0 0 538 111"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
            >
                <path
                d="M107.132 1.45999V109H100.368V17.344C100.368 16.0267 100.444 14.6333 100.596 13.164L58.264 88.328C57.5547 89.6453 56.5413 90.304 55.224 90.304H54.008C52.6907 90.304 51.6773 89.6453 50.968 88.328L7.496 13.012C7.648 14.532 7.724 15.976 7.724 17.344V109H0.884V1.45999H6.28C6.98933 1.45999 7.54667 1.53599 7.952 1.688C8.35733 1.84 8.76267 2.24533 9.168 2.904L52.564 77.688C53.324 79.1067 53.9827 80.6267 54.54 82.248C54.844 81.4373 55.1733 80.652 55.528 79.892C55.8827 79.0813 56.2627 78.3213 56.668 77.612L98.848 2.904C99.2533 2.24533 99.6587 1.84 100.064 1.688C100.52 1.53599 101.103 1.45999 101.812 1.45999H107.132ZM221.923 1.45999V109H218.275C217.616 109 217.059 108.899 216.603 108.696C216.198 108.443 215.792 108.037 215.387 107.48L145.543 14.152C145.695 15.672 145.771 17.116 145.771 18.484V109H138.931V1.45999H142.807C143.516 1.45999 144.048 1.56133 144.403 1.764C144.808 1.91599 145.239 2.29599 145.695 2.904L215.387 96.004C215.235 94.484 215.159 93.04 215.159 91.672V1.45999H221.923ZM261.501 109H253.673V1.45999H261.501V109ZM301.134 51.088H307.518C308.481 51.088 309.317 51.0627 310.026 51.012C310.735 50.9107 311.369 50.7587 311.926 50.556C312.534 50.3533 313.066 50.0747 313.522 49.72C314.029 49.3147 314.561 48.8333 315.118 48.276L358.514 3.664C359.274 2.80266 360.009 2.21999 360.718 1.916C361.478 1.61199 362.365 1.45999 363.378 1.45999H369.61L322.642 49.72C321.679 50.7333 320.818 51.5187 320.058 52.076C319.349 52.6333 318.538 53.0893 317.626 53.444C318.69 53.748 319.653 54.2293 320.514 54.888C321.375 55.496 322.237 56.3067 323.098 57.32L372.574 109H366.266C364.949 109 363.986 108.848 363.378 108.544C362.821 108.189 362.263 107.657 361.706 106.948L316.258 60.436C315.701 59.8787 315.169 59.3973 314.662 58.992C314.206 58.5867 313.674 58.2573 313.066 58.004C312.509 57.7 311.825 57.4973 311.014 57.396C310.254 57.244 309.266 57.168 308.05 57.168H301.134V109H293.306V1.45999H301.134V51.088ZM456.518 55.192C456.518 64.616 455.505 72.7733 453.478 79.664C451.452 86.5547 448.69 92.2547 445.194 96.764C441.698 101.273 437.594 104.643 432.882 106.872C428.221 109.051 423.23 110.14 417.91 110.14C412.59 110.14 407.6 109.051 402.938 106.872C398.277 104.643 394.198 101.273 390.702 96.764C387.206 92.2547 384.445 86.5547 382.418 79.664C380.442 72.7733 379.454 64.616 379.454 55.192C379.454 45.768 380.442 37.6107 382.418 30.72C384.445 23.8293 387.206 18.1293 390.702 13.62C394.198 9.11066 398.277 5.76666 402.938 3.58799C407.6 1.35866 412.59 0.243991 417.91 0.243991C423.23 0.243991 428.221 1.35866 432.882 3.58799C437.594 5.76666 441.698 9.11066 445.194 13.62C448.69 18.1293 451.452 23.8293 453.478 30.72C455.505 37.6107 456.518 45.768 456.518 55.192ZM448.918 55.192C448.918 46.4773 448.082 39.0293 446.41 32.848C444.738 26.6667 442.484 21.6253 439.646 17.724C436.86 13.772 433.566 10.884 429.766 9.06C426.017 7.23599 422.065 6.32399 417.91 6.32399C413.756 6.32399 409.804 7.23599 406.054 9.06C402.305 10.884 399.012 13.772 396.174 17.724C393.337 21.6253 391.082 26.6667 389.41 32.848C387.738 39.0293 386.902 46.4773 386.902 55.192C386.902 63.9573 387.738 71.4307 389.41 77.612C391.082 83.7427 393.337 88.784 396.174 92.736C399.012 96.6373 402.305 99.5 406.054 101.324C409.804 103.097 413.756 103.984 417.91 103.984C422.065 103.984 426.017 103.097 429.766 101.324C433.566 99.5 436.86 96.6373 439.646 92.736C442.484 88.784 444.738 83.7427 446.41 77.612C448.082 71.4307 448.918 63.9573 448.918 55.192ZM537.85 103.376V109H482.37V103.376H507.07V16.128C507.07 14.4053 507.146 12.5813 507.298 10.656L483.586 31.708C482.877 32.316 482.167 32.544 481.458 32.392C480.749 32.24 480.191 31.936 479.786 31.48L477.582 28.44L508.666 1.00399H514.366V103.376H537.85Z"
                fill="#434448"
                />
            </svg>
            </div>
        )}
        </div>
      ),
      {
        width: 1200,
        height: 630,
        emoji: 'twemoji',
      },
    );
  } catch (e: any) {
    console.log(`${e.message}`);
    return new Response(`Failed to generate the image`, {
      status: 500,
    });
  }
}
